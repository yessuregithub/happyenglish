<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>哈彼英语</title>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link href="css/style.css" rel="stylesheet" />

	</head>
	<body>
		<div id="orientLayer">
			<div class="wt-box">
				<div class="dl-bg"><img src="images/dl-bg.png"></div>
				<a href="" class="dl-lgoo"><img src="images/logo.png"></a>

				<div class="dl-box">
					<form>
						<div class="dl-list">
							<div class="item">
								<input name="" type="text" class="text" id=mobile placeholder="请输入手机号">
							</div>
							<div class="item">
								<input id=verify name="" type="text" class="text" placeholder="请输入验证码">
								<button type="button" class="yanzhengma">发送验证码</button>
							</div>
							<button type="button" class="submit" id="login">登录 / 注册</button>

						</div>
					</form>
				</div>
			</div>
		</div>

		<!---竖屏提示--->
		<div class="mod-orient-layer">
			<div class="mod-orient-layer__content">
				<div class="mod-orient-layer__icon-orient">
				</div>
				<span>为了更好的体验，请使用横屏浏览</span>
			</div>
		</div>



		<script src="js/mui.min.js"></script>
		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="js/rem.js"></script>
		<script src="js/common.js"></script>
		<script>
			var times = 60;

			function roof() {
				if (times == 0) {
					$('.yanzhengma').text('发送验证码(' + times + 's)');
					$('.yanzhengma').prop('disabled', false);
					$('.yanzhengma').text('发送验证码');
					times = 60;
					return
				}
				$('.yanzhengma').text('发送验证码(' + times + 's)');
				times--;
				setTimeout(roof, 1000);
			}
			$('.yanzhengma').on('click', function() {

				$(this).prop('disabled', true);
				roof();
				sendverifycode();

			});


			$('#login').on('click', function() {
				var mobile = $("#mobile").val();
				var verify = $("#verify").val();
				if (mobile.length != 11 || verify.length != 6) {
					mui.alert('请输入 正确的手机号和验证码');
					return;
				}
				mui.ajax({
					url: 'http://47.241.5.29/Home_index_login.html',
					data: {
						mobile: mobile,
						verify: verify,
					},
					async: true,
					dataType: 'json',
					type: 'post',
					timeout: 10000,
					success: function(data) {
						// 请求成功
						if (data.rst == 0) {
							mui.alert(data.msg);
							return;
						}
						if (data.rst == 1) {
							var token = data.token;
							localStorage.setItem("token", token);
							jump('index','index.html');
						}
					},
					error: function(xhr, type, errorThrown) {
						// 请求失败  
						mui.alert("网络错误，请稍后再试");
					}
				});

			});

			function sendverifycode() {
				var mobilenumber = $("#mobile").val();
				if (mobilenumber.length != 11) {
					mui.alert('请输入正确的手机号');
					return;
				}
				mui.ajax({
					url: 'http://47.241.5.29/Home_index_sendsms.html',
					data: {
						mobile: mobilenumber,
					},
					async: true,
					dataType: 'json',
					type: 'post',
					timeout: 10000,
					success: function(data) {
						// 请求成功
						mui.alert(data.msg);
					},
					error: function(xhr, type, errorThrown) {
						// 请求失败  
						mui.alert("网络错误，请稍后再试");
					}
				});
			}

			mui.ready(function() {

			});
			mui.plusReady(function() {
				plus.screen.lockOrientation("landscape-primary");

			});
		</script>
		<script>
			function horizontalScreen(className) {
				// transform 强制横屏
				var conW = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
				var conH = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
				// transform: rotate(90deg); width: 667px; height: 375px;transform-origin:28% 50%;
				//var iosTopHe = 0;//若有其他样式判断，写于此

				$(className).css({
					"transform": "rotate(90deg) translate(" + ((conH - conW) / 2) + "px," + ((conH - conW) / 2) + "px)",
					"width": conH + "px",
					"height": conW + "px",
					//"margin-top":iosTopHe+"px",
					// "border-left":iosTopHe+"px solid #000",
					"transform-origin": "center center",
					"-webkit-transform-origin": "center center"
				});
			}
		</script>

		<script>
			var orientLayer = document.getElementById("orientLayer");
			//判断横屏竖屏 
			function checkDirect() {
				if (document.documentElement.clientHeight >= document.documentElement.clientWidth) {
					return "portrait";
				} else {
					return "landscape";
				}
			}
			//显示屏幕方向提示浮层 
			function orientNotice() {
				var orient = checkDirect();
				if (orient == "portrait") {
					orientLayer.style.display = "none";
				} else {
					orientLayer.style.display = "block";
				}
			}

			function init() {
				orientNotice();
				window.addEventListener("onorientationchange" in window ? "orientationchange" : "resize", function() {
					setTimeout(orientNotice, 200);
				})
			}
			init();
		</script>
	</body>
</html>
